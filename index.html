<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Datto BDR – Pilot Test Report</title>

<style>
:root{
  --bg:#0b1020;
  --card:#141b33;
  --border:#25305c;
  --primary:#1f6fff;
  --success:#2ecc71;
  --danger:#e74c3c;
  --warning:#f1c40f;
  --text:#e6e9f2;
  --muted:#9aa4d1;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  background:linear-gradient(160deg,#0b1020,#0e1533);
  font-family:Inter,Segoe UI,Arial,sans-serif;
  color:var(--text);
  padding:20px;
}

.container{
  max-width:1200px;
  margin:auto;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
}

.header{
  padding:25px;
  border-bottom:2px solid var(--primary);
}

.header h1{
  font-size:22px;
  color:var(--primary);
}

.subtitle{
  color:var(--muted);
  font-size:13px;
  margin-top:5px;
}

.client-id{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 20px;
  border-bottom:1px solid var(--border);
  background:#10162e;
  font-size:13px;
}

.action-bar{
  position:fixed;
  top:20px;
  right:20px;
}

.btn{
  background:var(--primary);
  border:none;
  color:white;
  padding:10px 18px;
  border-radius:6px;
  cursor:pointer;
  font-weight:600;
}

.btn:hover{opacity:.9}

.content{padding:25px}

.section{
  margin-bottom:25px;
  border:1px solid var(--border);
  border-radius:8px;
  padding:18px;
  background:#10162e;
}

.section-title{
  margin-bottom:15px;
  font-size:14px;
  font-weight:700;
  color:var(--primary);
  text-transform:uppercase;
}

label{
  font-size:12px;
  color:var(--muted);
  display:block;
  margin-bottom:5px;
}

input,textarea,select{
  width:100%;
  padding:9px;
  background:#0b1020;
  border:1px solid var(--border);
  border-radius:4px;
  color:var(--text);
  margin-bottom:10px;
}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:15px}
.grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}

.dynamic-item{
  border:1px solid var(--border);
  border-radius:6px;
  padding:12px;
  margin-bottom:10px;
}

.dynamic-item-header{
  display:flex;
  justify-content:space-between;
  margin-bottom:10px;
  font-weight:600;
}

.btn-add{
  background:none;
  border:1px dashed var(--primary);
  color:var(--primary);
  padding:8px;
  cursor:pointer;
  border-radius:5px;
}

.btn-remove{
  background:none;
  border:1px solid var(--danger);
  color:var(--danger);
  padding:4px 8px;
  border-radius:4px;
  cursor:pointer;
}

.checklist-item{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:6px;
}

@media print{
  .action-bar{display:none}
  body{background:white;color:black}
  .container{border:none}
}
</style>
</head>

<body>

<div class="action-bar">
  <button class="btn" onclick="window.print()">Exportar PDF</button>
</div>

<div class="container">
<div class="header">
<h1>Datto BDR – Pilot Test</h1>
<div class="subtitle">Backup & Disaster Recovery – Validation Report</div>
</div>

<div class="client-id">
<div>CLIENTE: <strong id="clientDisplay">default</strong></div>
<div>Auto-guardado activo</div>
</div>

<div class="content">

<!-- PROJECT -->
<div class="section">
<div class="section-title">Información del Proyecto</div>
<div class="grid-2">
<div>
<label>Cliente</label>
<input id="cliente">
</div>
<div>
<label>Fecha de Prueba</label>
<input type="date" id="fechaPrueba">
</div>
</div>

<label>Ingenieros Responsables</label>
<div id="ingenierosContainer"></div>
<button class="btn-add" onclick="addIngeniero()">+ Agregar ingeniero</button>

<label style="margin-top:15px">Contactos del Cliente</label>
<div id="contactosContainer"></div>
<button class="btn-add" onclick="addContacto()">+ Agregar contacto</button>

<label style="margin-top:15px">Ventana de Prueba</label>
<input id="ventanaPrueba">
</div>

<!-- ALCANCE -->
<div class="section">
<div class="section-title">Alcance</div>
<div class="grid-2">
<textarea id="alcanceSi" placeholder="Incluye..."></textarea>
<textarea id="alcanceNo" placeholder="Excluye..."></textarea>
</div>
</div>

<!-- CONFIG -->
<div class="section">
<div class="section-title">Configuración Datto</div>
<div class="grid-2">
<input id="modeloAppliance" placeholder="Modelo">
<input id="serialEquipo" placeholder="Serial">
<select id="agenteInstalado">
<option value="">Agente</option>
<option>Windows</option>
<option>Linux</option>
<option>Agentless</option>
</select>
<input id="politicaBackup" placeholder="Política">
</div>
</div>

<!-- OBS -->
<div class="section">
<div class="section-title">Observaciones</div>
<textarea id="observaciones" rows="4"></textarea>
</div>

</div>
</div>

<script>
const urlParams=new URLSearchParams(location.search);
const clientId=urlParams.get("client")||"default";
document.getElementById("clientDisplay").textContent=clientId;
const KEY="datto-"+clientId;

let data=JSON.parse(localStorage.getItem(KEY))||{
cliente:"",fechaPrueba:"",ingenieros:[""],contactos:[],ventanaPrueba:"",
alcanceSi:"",alcanceNo:"",modeloAppliance:"",serialEquipo:"",
agenteInstalado:"",politicaBackup:"",observaciones:""
};

function save(){localStorage.setItem(KEY,JSON.stringify(data));}

document.querySelectorAll("input,textarea,select").forEach(e=>{
e.onchange=()=>{data[e.id]=e.value;save();}
});

function renderIngenieros(){
const c=document.getElementById("ingenierosContainer");c.innerHTML="";
data.ingenieros.forEach((v,i)=>{
c.innerHTML+=`<div style="display:flex;gap:10px">
<input value="${v}" onchange="data.ingenieros[${i}]=this.value;save()">
${data.ingenieros.length>1?`<button class="btn-remove" onclick="data.ingenieros.splice(${i},1);renderIngenieros();save()">X</button>`:""}
</div>`;
});
}
function addIngeniero(){data.ingenieros.push("");renderIngenieros();save();}

function renderContactos(){
const c=document.getElementById("contactosContainer");c.innerHTML="";
data.contactos.forEach((o,i)=>{
c.innerHTML+=`
<div class="dynamic-item">
<div class="dynamic-item-header">Contacto ${i+1}
<button class="btn-remove" onclick="data.contactos.splice(${i},1);renderContactos();save()">Eliminar</button>
</div>
<div class="grid-4">
<input placeholder="Nombre" value="${o.nombre||""}" onchange="o.nombre=this.value;save()">
<input placeholder="Cargo" value="${o.cargo||""}" onchange="o.cargo=this.value;save()">
<input placeholder="Teléfono" value="${o.telefono||""}" onchange="o.telefono=this.value;save()">
<input placeholder="Email" value="${o.email||""}" onchange="o.email=this.value;save()">
</div>
</div>`;
});
}
function addContacto(){data.contactos.push({});renderContactos();save();}

renderIngenieros();
renderContactos();
</script>

</body>
</html>
